CONTENT_ORIGIN = "{{ pulp_scheme }}://pulp:{{ 443 if pulp_scheme == 'https' else 80 }}"
ANSIBLE_API_HOSTNAME = "{{ pulp_scheme }}://pulp:{{ 443 if pulp_scheme == 'https' else 80 }}"
ANSIBLE_CONTENT_HOSTNAME = "{{ pulp_scheme }}://pulp:{{ 443 if pulp_scheme == 'https' else 80 }}/pulp/content"
PRIVATE_KEY_PATH = "/etc/pulp/certs/token_private_key.pem"
PUBLIC_KEY_PATH = "/etc/pulp/certs/token_public_key.pem"
TOKEN_SERVER = "{{ pulp_scheme }}://pulp:{{ 443 if pulp_scheme == 'https' else 80 }}/token/"
TOKEN_SIGNATURE_ALGORITHM = "ES256"
CACHE_ENABLED = True
REDIS_HOST = "localhost"
REDIS_PORT = 6379
ANALYTICS = False

{% if api_root is defined %}
API_ROOT = {{ api_root | repr }}
{% endif %}

{% if pulp_settings %}
{% for key, value in pulp_settings.items() %}
{{ key | upper }} = {{ value | repr }}
{% endfor %}
{% endif %}

{% if pulp_scenario_settings is defined and pulp_scenario_settings %}
{% for key, value in pulp_scenario_settings.items() %}
{{ key | upper }} = {{ value | repr }}
{% endfor %}
{% endif %}

{% if s3_test | default(false) %}
MEDIA_ROOT = ""
STORAGES = {
    "default": {
        "BACKEND": "storages.backends.s3boto3.S3Boto3Storage",
        "OPTIONS": {
            "access_key": "{{ minio_access_key }}",
            "secret_key": "{{ minio_secret_key }}",
            "region_name": "eu-central-1",
            "addressing_style": "path",
            "signature_version": "s3v4",
            "bucket_name": "pulp3",
            "endpoint_url": "http://minio:9000",
            "default_acl": "@none None",
        }
    }
}
# TODO: this looks deprecated. Its a bit hard to find info but:
# a) it shows in boto repository (deprecated/archived)
# b) it doesnt show in boto3 repository: https://github.com/search?q=repo%3Aboto%2Fboto3%20USE_SIGV4&type=code
S3_USE_SIGV4 = True
{% endif %}

{% if azure_test | default(false) %}
MEDIA_ROOT = ""
STORAGES = {
    "default": {
        "BACKEND": "storages.backends.azure_storage.AzureStorage",
        "OPTIONS": {
            "account_key": "Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==",
            "account_name": "devstoreaccount1",
            "azure_container": "pulp-test",
            "location": "pulp3",
            "overwrite_files": True,
            "expiration_secs": 120,
            "connection_string": 'DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==;BlobEndpoint=http://ci-azurite:10000/devstoreaccount1;',
        }
    }
}
{% endif %}

{% if gcp_test | default(false) %}
STORAGES = {
    "default": {
        "BACKEND": "storages.backends.gcloud.GoogleCloudStorage",
        "OPTIONS": {
            "media_root": "",
            "gs_bucket_name": "gcppulp",
            "gs_custom_endpoint": "http://ci-gcp:4443",
        }
    }
}
{% endif %}

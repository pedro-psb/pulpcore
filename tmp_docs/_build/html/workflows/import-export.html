<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pulp Import and Export &mdash; Pulp Project 3.23.0.dev documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Labels" href="labels.html" />
    <link rel="prev" title="Reclaim disk space for a list of repositories" href="reclaim-disk-space.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Pulp Project
          </a>
              <div class="version">
                3.23.0.dev
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../concepts.html">Concepts and Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../from-pulp-2.html">Changes From Pulp 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authentication/index.html">Authentication</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Workflows and Use Cases</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="alternate-content-sources.html">Alternate Content Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="upload-publish.html">Upload and Publish</a></li>
<li class="toctree-l2"><a class="reference internal" href="repo-versioning.html">Repository Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="on-demand-downloading.html">On-Demand Downloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="promotion.html">Promotion</a></li>
<li class="toctree-l2"><a class="reference internal" href="scheduling-tasks.html">Scheduling Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="exposing-content.html">Exposing Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="signed-metadata.html">Metadata Signing</a></li>
<li class="toctree-l2"><a class="reference internal" href="repairing-pulp.html">Repairing Pulp</a></li>
<li class="toctree-l2"><a class="reference internal" href="reclaim-disk-space.html">Reclaim disk space for a list of repositories</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Pulp Import and Export</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#definitions">Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#assumptions">Assumptions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#on-demand-content-not-supported">On-Demand content not supported</a></li>
<li class="toctree-l4"><a class="reference internal" href="#export-import-directories-must-be-explicitly-allowed">Export/Import Directories must be explicitly allowed</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installed-plugins-must-match">Installed plugins must match</a></li>
<li class="toctree-l4"><a class="reference internal" href="#version-compatibility-required">Version-compatibility required</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exporting">Exporting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-an-exporter">Creating an Exporter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exporting-content">Exporting Content</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exporting-specific-versions">Exporting Specific Versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exporting-incrementally">Exporting Incrementally</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exporting-chunked-files">Exporting Chunked Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#updating-an-exporter">Updating an Exporter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#importing">Importing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-the-importer">Creating the importer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pre-validating-import-parameters">Pre-validating import parameters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="labels.html">Labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-removal.html">Plugin removal</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugin_dev/index.html">Plugin Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rest_api.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client_bindings.html">Client Bindings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bugs-features.html">Bugs, Feature and Backport Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versioning.html">Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_process.html">Pulpcore Release Process</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Pulp Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Workflows and Use Cases</a></li>
      <li class="breadcrumb-item active">Pulp Import and Export</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/workflows/import-export.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pulp-import-and-export">
<h1>Pulp Import and Export<a class="headerlink" href="#pulp-import-and-export" title="Permalink to this heading">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Support for import and export is provided as a tech preview in Pulp 3. Functionality may not
work or may be incomplete. Also, backwards compatibility when upgrading is not guaranteed.</p>
</div>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>There is a use-case for extracting the content and <a class="reference internal" href="../glossary.html#term-Artifact"><span class="xref std std-term">Artifacts</span></a> for a set of
<a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersions</span></a>, out of a running instance of Pulp and into
a file that can then be transferred to another Pulp instance and imported. This is not
the Pulp-to-Pulp sync case; the assumption is that the receiving Pulp instance is
network-isolated.</p>
<p>The high-level workflow for this use case is</p>
<p>1. On the Upstream Pulp instance, an Exporter is defined for the set of
<a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a> that are to be exported to some Downstream Pulp instance.</p>
<p>2. That Exporter is requested to produce and execute an Export for the current
<a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersions</span></a> of the specified
<a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a></p>
<ol class="arabic simple" start="3">
<li><p>The resulting <code class="docutils literal notranslate"><span class="pre">.tar.gz</span></code> Export is transferred to the appropriate Downstream.</p></li>
</ol>
<p>4. On the Downstream Pulp instance, an Importer is defined, that maps the incoming
Upstream <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a> to matching Downstream
<a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a>.</p>
<p>5. That Importer is requested to produce and execute an Import, pointing to the provided
export file from the Upstream.</p>
<p>In order to minimize space utilization, import/export operates on sets of
<a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a>. This allows the Export operation to export shared
<a class="reference internal" href="../glossary.html#term-Artifact"><span class="xref std std-term">Artifacts</span></a> only once per-export, rather than once for each
<a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repository</span></a> being exported.</p>
</section>
<section id="definitions">
<h2>Definitions<a class="headerlink" href="#definitions" title="Permalink to this heading">¶</a></h2>
<dl class="simple">
<dt>Upstream</dt><dd><p>Pulp instance whose <a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersions</span></a> we want to export</p>
</dd>
<dt>Downstream</dt><dd><p>Pulp instance that will be importing those <a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersions</span></a></p>
</dd>
<dt>ModelResource</dt><dd><p>entity that understands how to map the metadata for a specific Model
owned/controlled by a plugin to an exportable file-format
(see <a class="reference external" href="https://django-import-export.readthedocs.io/en/latest/api_resources.html#modelresource">django-import-export</a>)</p>
</dd>
<dt>Exporter</dt><dd><p>resource that exports content from Pulp for a variety of different use cases</p>
</dd>
<dt>PulpExporter</dt><dd><p>kind-of Exporter, that is specifically used to export data from an Upstream
for consumption by a Downstream</p>
</dd>
<dt>PulpExport</dt><dd><p>specific instantiation/run of a PulpExporter</p>
</dd>
<dt>Export file</dt><dd><p>compressed tarfile containing database content and <a class="reference internal" href="../glossary.html#term-Artifact"><span class="xref std std-term">Artifacts</span></a> for
<a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersions</span></a>, generated during execution of an Export</p>
</dd>
<dt>PulpImporter</dt><dd><p>resource that accepts an Upstream PulpExporter export file, and manages
the process of importing the content and <a class="reference internal" href="../glossary.html#term-Artifact"><span class="xref std std-term">Artifacts</span></a> included</p>
</dd>
<dt>PulpImport</dt><dd><p>specific instantiation/run of a PulpImporter</p>
</dd>
<dt>Repository-mapping</dt><dd><p>configuration file that provides the ability to map an Upstream <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repository</span></a>,
to a Downstream <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repository</span></a>, into which the Upstream’s <a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersion</span></a>
should be imported by a PulpImporter</p>
</dd>
<dt>Import order</dt><dd><p>for complicated repository-types, managing relationships requires that
ModelResources be imported in order. Plugins are responsible for specifying the
import-order of the ModelResources they own</p>
</dd>
</dl>
</section>
<section id="assumptions">
<h2>Assumptions<a class="headerlink" href="#assumptions" title="Permalink to this heading">¶</a></h2>
<p>The import/export workflow operates on a set of assumptions. Violating them will result
in error-messages as described below.</p>
<section id="on-demand-content-not-supported">
<h3>On-Demand content not supported<a class="headerlink" href="#on-demand-content-not-supported" title="Permalink to this heading">¶</a></h3>
<p>Export will not operate on <a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersions</span></a> that have
been synchronized using <code class="docutils literal notranslate"><span class="pre">policy=on_demand</span></code> or <code class="docutils literal notranslate"><span class="pre">policy=streamed</span></code>. <a class="reference internal" href="../glossary.html#term-Artifact"><span class="xref std std-term">Artifacts</span></a>
must actually exist in order to be exported - this is, after
all the only way for the Downstream Pulp instance to gain access to them!</p>
<p>If a repository is specified for export that utilized on-demand/streamed syncing, the
export will fail with a RuntimeError:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Remote</span> <span class="pre">artifacts</span> <span class="pre">cannot</span> <span class="pre">be</span> <span class="pre">exported.</span></code></p>
</div></blockquote>
</section>
<section id="export-import-directories-must-be-explicitly-allowed">
<h3>Export/Import Directories must be explicitly allowed<a class="headerlink" href="#export-import-directories-must-be-explicitly-allowed" title="Permalink to this heading">¶</a></h3>
<p>Import and Export strictly control which directories may be read from/written to via
the settings options <code class="docutils literal notranslate"><span class="pre">ALLOWED_IMPORT_PATHS</span></code> and <code class="docutils literal notranslate"><span class="pre">ALLOWED_EXPORT_PATHS</span></code>.
These default to empty - if they not explicitly set, attempts to import or export will fail
with a validation error like</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">&quot;Path</span> <span class="pre">'/tmp/exports/'</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">an</span> <span class="pre">allowed</span> <span class="pre">export</span> <span class="pre">path&quot;</span></code></p>
</div></blockquote>
</section>
<section id="installed-plugins-must-match">
<h3>Installed plugins must match<a class="headerlink" href="#installed-plugins-must-match" title="Permalink to this heading">¶</a></h3>
<p>A Downstream must support the complete set of plugins present in a given export. If the
export includes plugins that are not installed in the Downstream, an import attempt will
fail with a validation error like</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Export</span> <span class="pre">uses</span> <span class="pre">pulp_rpm</span> <span class="pre">which</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">installed.</span></code></p>
</div></blockquote>
</section>
<section id="version-compatibility-required">
<h3>Version-compatibility required<a class="headerlink" href="#version-compatibility-required" title="Permalink to this heading">¶</a></h3>
<p>The export-to-import workflow is built on the assumption that the Upstream and
Downstream instances are running “compatible” versions of pulpcore and plugins. In this
context, “compatible” is defined as <strong>“share the same X.Y version”</strong>.  If this is not the
case, an import attempt will fail with a validation error like</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Export</span> <span class="pre">version</span> <span class="pre">3.14.15</span> <span class="pre">of</span> <span class="pre">pulpcore</span> <span class="pre">incompatible</span> <span class="pre">with</span> <span class="pre">installed</span> <span class="pre">version</span> <span class="pre">3.16.3.</span></code></p>
</div></blockquote>
</section>
</section>
<section id="exporting">
<h2>Exporting<a class="headerlink" href="#exporting" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following examples assume a Pulp instance that includes the <code class="docutils literal notranslate"><span class="pre">pulp_file</span></code> and
<code class="docutils literal notranslate"><span class="pre">pulp_rpm</span></code> plugins. They also assume that the <code class="docutils literal notranslate"><span class="pre">http</span></code> and <code class="docutils literal notranslate"><span class="pre">jq</span></code> packages are
installed.</p>
</div>
<p>These workflows are executed on an Upstream Pulp instance.</p>
<section id="creating-an-exporter">
<h3>Creating an Exporter<a class="headerlink" href="#creating-an-exporter" title="Permalink to this heading">¶</a></h3>
<p>In this workflow, you define an Exporter for a set of <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a>.
This Exporter can be invoked repeatedly to regularly export the current
<a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersion</span></a> of each of the specified <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a>.</p>
<p>First, let’s make a pair of <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a> named <code class="docutils literal notranslate"><span class="pre">zoo</span></code> and <code class="docutils literal notranslate"><span class="pre">isofile</span></code>,
and save their UUIDs as <code class="docutils literal notranslate"><span class="pre">ZOO_UUID</span></code> and <code class="docutils literal notranslate"><span class="pre">ISOFILE_UUID</span></code></p>
<p>Set up ‘zoo’ repository”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Create the repository
export ZOO_HREF=$(http POST :/pulp/api/v3/repositories/rpm/rpm/ name=zoo | jq -r &#39;.pulp_href&#39;)
#
# add a remote
http POST :/pulp/api/v3/remotes/rpm/rpm/ name=zoo url=https://fixtures.pulpproject.org/rpm-signed/  policy=&#39;immediate&#39;
#
# find remote&#39;s href
export REMOTE_HREF=$(http :/pulp/api/v3/remotes/rpm/rpm/ | jq -r &quot;.results[] | select(.name == \&quot;zoo\&quot;) | .pulp_href&quot;)
#
# sync the repository to give us some content
http POST :$ZOO_HREF&#39;sync/&#39; remote=$REMOTE_HREF
</pre></div>
</div>
<p>Set up ‘isofile’ repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># create the repository
ISOFILE_HREF=$(http POST :/pulp/api/v3/repositories/file/file/ name=isofile | jq -r &#39;.pulp_href&#39;)
#
# add remote
http POST :/pulp/api/v3/remotes/file/file/ name=isofile url=https://fixtures.pulpproject.org/file/PULP_MANIFEST
#
# find remote&#39;s href
REMOTE_HREF=$(http :/pulp/api/v3/remotes/file/file/ | jq -r &quot;.results[] | select(.name == \&quot;isofile\&quot;) | .pulp_href&quot;)
#
# sync the repository to give us some content
http POST :$ISOFILE_HREF&#39;sync/&#39; remote=$REMOTE_HREF
</pre></div>
</div>
<p>Now that we have <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a> with content, let’s define an Exporter named <code class="docutils literal notranslate"><span class="pre">test-exporter</span></code>
that will export these <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a> to the directory <code class="docutils literal notranslate"><span class="pre">/tmp/exports/</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export EXPORTER_HREF=$(http POST :/pulp/api/v3/exporters/core/pulp/ \
    name=test-exporter                                              \
    repositories:=[\&quot;${ISOFILE_HREF}\&quot;,\&quot;${ZOO_HREF}\&quot;]             \
    path=/tmp/exports/ | jq -r &#39;.pulp_href&#39;)
http GET :${EXPORTER_HREF}
</pre></div>
</div>
</section>
<section id="exporting-content">
<h3>Exporting Content<a class="headerlink" href="#exporting-content" title="Permalink to this heading">¶</a></h3>
<p>Once we have an Exporter defined, we invoke it to generate an export-file in the directory
specified by that Exporter’s <code class="docutils literal notranslate"><span class="pre">path</span></code> attribute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http POST :${EXPORTER_HREF}exports/
</pre></div>
</div>
<p>The resulting Export writes to a <code class="docutils literal notranslate"><span class="pre">.tar.gz</span></code> file, in the directory pointed to by the
Exporter’s path, with a name that follows the convention <code class="docutils literal notranslate"><span class="pre">export-&lt;export-UUID&gt;-YYYYmmdd_HHMM.tar.gz</span></code>.</p>
<p>It will also produce a “table of contents” file describing the file (or files, see
<a class="reference internal" href="#exporting-chunked-files">Exporting Chunked Files</a> below) for later use verifying and importing the results of the export:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">exports</span>
<span class="n">export</span><span class="o">-</span><span class="mi">32</span><span class="n">fd25c7</span><span class="o">-</span><span class="mi">18</span><span class="n">b2</span><span class="o">-</span><span class="mi">42</span><span class="n">de</span><span class="o">-</span><span class="n">b2f8</span><span class="o">-</span><span class="mi">16</span><span class="n">f6d90358c3</span><span class="o">-</span><span class="mf">20200416_2000.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">export</span><span class="o">-</span><span class="mi">32</span><span class="n">fd25c7</span><span class="o">-</span><span class="mi">18</span><span class="n">b2</span><span class="o">-</span><span class="mi">42</span><span class="n">de</span><span class="o">-</span><span class="n">b2f8</span><span class="o">-</span><span class="mi">16</span><span class="n">f6d90358c3</span><span class="o">-</span><span class="mi">20200416_2000</span><span class="o">-</span><span class="n">toc</span><span class="o">.</span><span class="n">json</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">json</span><span class="o">.</span><span class="n">tool</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">exports</span><span class="o">/</span><span class="n">export</span><span class="o">-</span><span class="mi">32</span><span class="n">fd25c7</span><span class="o">-</span><span class="mi">18</span><span class="n">b2</span><span class="o">-</span><span class="mi">42</span><span class="n">de</span><span class="o">-</span><span class="n">b2f8</span><span class="o">-</span><span class="mi">16</span><span class="n">f6d90358c3</span><span class="o">-</span><span class="mi">20200416_2000</span><span class="o">-</span><span class="n">toc</span><span class="o">.</span><span class="n">json</span>
    <span class="p">{</span>
    <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;chunk_size&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># chunk_size in bytes, or 0 if an export did not use the chunk_size parameter</span>
        <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;export-32fd25c7-18b2-42de-b2f8-16f6d90358c3-20200416_2000.tar.gz&quot;</span><span class="p">,</span>
        <span class="s2">&quot;global_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;eaef962943915ecf6b5e45877b162364284bd9c4f367d9c96d18c408012ef424&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;export-32fd25c7-18b2-42de-b2f8-16f6d90358c3-20200416_2000.tar.gz&quot;</span><span class="p">:</span> <span class="s2">&quot;eaef962943915ecf6b5e45877b162364284bd9c4f367d9c96d18c408012ef424&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>These export files can now be transferred to a Downstream Pulp instance, and imported.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the event of any failure during an export, the process will clean up any partial
export-files that may have been generated. Export-files can be very large; this will
preserve available space in the export-directory.</p>
</div>
</section>
<section id="exporting-specific-versions">
<h3>Exporting Specific Versions<a class="headerlink" href="#exporting-specific-versions" title="Permalink to this heading">¶</a></h3>
<p>By default, the latest-versions of the <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a> specified in the Exporter are exported. However, you
can export specific <a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersions</span></a> of those <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a>
if you wish using the <code class="docutils literal notranslate"><span class="pre">versions=</span></code> parameter on the <code class="docutils literal notranslate"><span class="pre">/exports/</span></code> invocation.</p>
<p>Following the above example - let’s assume we want to export the “zero’th” <a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersion</span></a> of the
repositories in our Exporter.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http POST :${EXPORTER_HREF}exports/ \
    versions:=[\&quot;${ISO_HREF}versions/0/\&quot;,\&quot;${ZOO_HREF}versions/0/\&quot;]
</pre></div>
</div>
<p>Note that the “zero’th” <a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersion</span></a> of a <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repository</span></a> is created when the <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repository</span></a> is created, and is empty. If you unpack the resulting Export <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> you will find, for example, that there is no <code class="docutils literal notranslate"><span class="pre">artifacts/</span></code> directory and an empty <code class="docutils literal notranslate"><span class="pre">ArtifactResource.json</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">exports</span>
<span class="n">tar</span> <span class="n">xvzf</span> <span class="n">export</span><span class="o">-</span><span class="mi">930</span><span class="n">ea60c</span><span class="o">-</span><span class="mi">97</span><span class="n">b7</span><span class="o">-</span><span class="mf">4e00</span><span class="o">-</span><span class="n">a737</span><span class="o">-</span><span class="mi">70</span><span class="n">f773ebbb14</span><span class="o">-</span><span class="mf">20200511_2005.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
    <span class="n">versions</span><span class="o">.</span><span class="n">json</span>
    <span class="n">pulpcore</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">ArtifactResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">pulpcore</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">RepositoryResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">3</span><span class="n">c1ec06a</span><span class="o">-</span><span class="n">b0d6</span><span class="o">-</span><span class="mi">4</span><span class="n">d04</span><span class="o">-</span><span class="mi">9</span><span class="n">f99</span><span class="o">-</span><span class="mi">32</span><span class="n">bfc0a499a9_0</span><span class="o">/</span><span class="n">pulpcore</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">ContentResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">3</span><span class="n">c1ec06a</span><span class="o">-</span><span class="n">b0d6</span><span class="o">-</span><span class="mi">4</span><span class="n">d04</span><span class="o">-</span><span class="mi">9</span><span class="n">f99</span><span class="o">-</span><span class="mi">32</span><span class="n">bfc0a499a9_0</span><span class="o">/</span><span class="n">pulpcore</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">ContentArtifactResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">3</span><span class="n">c1ec06a</span><span class="o">-</span><span class="n">b0d6</span><span class="o">-</span><span class="mi">4</span><span class="n">d04</span><span class="o">-</span><span class="mi">9</span><span class="n">f99</span><span class="o">-</span><span class="mi">32</span><span class="n">bfc0a499a9_0</span><span class="o">/</span><span class="n">pulp_rpm</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">PackageResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">3</span><span class="n">c1ec06a</span><span class="o">-</span><span class="n">b0d6</span><span class="o">-</span><span class="mi">4</span><span class="n">d04</span><span class="o">-</span><span class="mi">9</span><span class="n">f99</span><span class="o">-</span><span class="mi">32</span><span class="n">bfc0a499a9_0</span><span class="o">/</span><span class="n">pulp_rpm</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">ModulemdResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">3</span><span class="n">c1ec06a</span><span class="o">-</span><span class="n">b0d6</span><span class="o">-</span><span class="mi">4</span><span class="n">d04</span><span class="o">-</span><span class="mi">9</span><span class="n">f99</span><span class="o">-</span><span class="mi">32</span><span class="n">bfc0a499a9_0</span><span class="o">/</span><span class="n">pulp_rpm</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">ModulemdDefaultsResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">3</span><span class="n">c1ec06a</span><span class="o">-</span><span class="n">b0d6</span><span class="o">-</span><span class="mi">4</span><span class="n">d04</span><span class="o">-</span><span class="mi">9</span><span class="n">f99</span><span class="o">-</span><span class="mi">32</span><span class="n">bfc0a499a9_0</span><span class="o">/</span><span class="n">pulp_rpm</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">PackageGroupResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">3</span><span class="n">c1ec06a</span><span class="o">-</span><span class="n">b0d6</span><span class="o">-</span><span class="mi">4</span><span class="n">d04</span><span class="o">-</span><span class="mi">9</span><span class="n">f99</span><span class="o">-</span><span class="mi">32</span><span class="n">bfc0a499a9_0</span><span class="o">/</span><span class="n">pulp_rpm</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">PackageCategoryResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">3</span><span class="n">c1ec06a</span><span class="o">-</span><span class="n">b0d6</span><span class="o">-</span><span class="mi">4</span><span class="n">d04</span><span class="o">-</span><span class="mi">9</span><span class="n">f99</span><span class="o">-</span><span class="mi">32</span><span class="n">bfc0a499a9_0</span><span class="o">/</span><span class="n">pulp_rpm</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">PackageEnvironmentResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">3</span><span class="n">c1ec06a</span><span class="o">-</span><span class="n">b0d6</span><span class="o">-</span><span class="mi">4</span><span class="n">d04</span><span class="o">-</span><span class="mi">9</span><span class="n">f99</span><span class="o">-</span><span class="mi">32</span><span class="n">bfc0a499a9_0</span><span class="o">/</span><span class="n">pulp_rpm</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">PackageLangpacksResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">3</span><span class="n">c1ec06a</span><span class="o">-</span><span class="n">b0d6</span><span class="o">-</span><span class="mi">4</span><span class="n">d04</span><span class="o">-</span><span class="mi">9</span><span class="n">f99</span><span class="o">-</span><span class="mi">32</span><span class="n">bfc0a499a9_0</span><span class="o">/</span><span class="n">pulp_rpm</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">UpdateRecordResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">3</span><span class="n">c1ec06a</span><span class="o">-</span><span class="n">b0d6</span><span class="o">-</span><span class="mi">4</span><span class="n">d04</span><span class="o">-</span><span class="mi">9</span><span class="n">f99</span><span class="o">-</span><span class="mi">32</span><span class="n">bfc0a499a9_0</span><span class="o">/</span><span class="n">pulp_rpm</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">DistributionTreeResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">3</span><span class="n">c1ec06a</span><span class="o">-</span><span class="n">b0d6</span><span class="o">-</span><span class="mi">4</span><span class="n">d04</span><span class="o">-</span><span class="mi">9</span><span class="n">f99</span><span class="o">-</span><span class="mi">32</span><span class="n">bfc0a499a9_0</span><span class="o">/</span><span class="n">pulp_rpm</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">RepoMetadataFileResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">958</span><span class="n">ae747</span><span class="o">-</span><span class="n">c19d</span><span class="o">-</span><span class="mi">4820</span><span class="o">-</span><span class="mi">828</span><span class="n">c</span><span class="o">-</span><span class="mi">87452</span><span class="n">f1a5b8d_0</span><span class="o">/</span><span class="n">pulpcore</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">ContentResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">958</span><span class="n">ae747</span><span class="o">-</span><span class="n">c19d</span><span class="o">-</span><span class="mi">4820</span><span class="o">-</span><span class="mi">828</span><span class="n">c</span><span class="o">-</span><span class="mi">87452</span><span class="n">f1a5b8d_0</span><span class="o">/</span><span class="n">pulpcore</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">ContentArtifactResource</span><span class="o">.</span><span class="n">json</span>
    <span class="n">repository</span><span class="o">-</span><span class="mi">958</span><span class="n">ae747</span><span class="o">-</span><span class="n">c19d</span><span class="o">-</span><span class="mi">4820</span><span class="o">-</span><span class="mi">828</span><span class="n">c</span><span class="o">-</span><span class="mi">87452</span><span class="n">f1a5b8d_0</span><span class="o">/</span><span class="n">pulp_file</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">FileContentResource</span><span class="o">.</span><span class="n">json</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">json</span><span class="o">.</span><span class="n">tool</span> <span class="n">pulpcore</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">modelresource</span><span class="o">.</span><span class="n">ArtifactResource</span><span class="o">.</span><span class="n">json</span>
    <span class="p">[]</span>
</pre></div>
</div>
</section>
<section id="exporting-incrementally">
<h3>Exporting Incrementally<a class="headerlink" href="#exporting-incrementally" title="Permalink to this heading">¶</a></h3>
<p>By default, PulpExport exports all of the content and artifacts of the
<a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersions</span></a> being exported. A common use-case is to do
regular transfers of content from an Upstream to a Downstream Pulp instance.  While you
<strong>can</strong> export everything every time, it is an inefficient use of time and disk storage to
do so; exporting only the “entities that have changed” is a better choice. You can
accomplish this by setting the <code class="docutils literal notranslate"><span class="pre">full</span></code> parameter on the <code class="docutils literal notranslate"><span class="pre">/exports/</span></code> invocation to
<code class="docutils literal notranslate"><span class="pre">False</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http POST :${EXPORTER_HREF}exports/ full=False
</pre></div>
</div>
<p>This results in an export of all content-entities, but only <a class="reference internal" href="../glossary.html#term-Artifact"><span class="xref std std-term">Artifacts</span></a>
that have been <strong>added</strong> since the <cite>last_export</cite> of the same Exporter.</p>
<p>You can override the use of <cite>last_export</cite> as the starting point of an incremental export by use of the <code class="docutils literal notranslate"><span class="pre">start_versions=</span></code>
parameter. Building on our example Exporter, if we want to do an incremental export of everything that’s happened since the
<strong>second</strong> <a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersion</span></a> of each <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repository</span></a>, regardless of what happened in our last export,
we would issue a command such as the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http POST :${EXPORTER_HREF}exports/ \
    full=False                      \
    start_versions:=[\&quot;${ISO_HREF}versions/1/\&quot;,\&quot;${ZOO_HREF}versions/1/\&quot;]
</pre></div>
</div>
<p>This would produce an incremental export of everything that had been added to our <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a>
between <a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersion</span></a> ‘1’ and the <code class="docutils literal notranslate"><span class="pre">current_version</span></code> <a class="reference internal" href="../glossary.html#term-RepositoryVersion"><span class="xref std std-term">RepositoryVersions</span></a>
of our <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a>.</p>
<p>Finally, if we need complete control over incremental exporting, we can combine the use of <code class="docutils literal notranslate"><span class="pre">start_versions=</span></code> and <code class="docutils literal notranslate"><span class="pre">versions=</span></code>
to produce an incremental export of everything that happened after <code class="docutils literal notranslate"><span class="pre">start_versions=</span></code> up to and including <code class="docutils literal notranslate"><span class="pre">versions=</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http POST :${EXPORTER_HREF}exports/                                         \
    full=False                                                              \
    start_versions:=[\&quot;${ISO_HREF}versions/1/\&quot;,\&quot;${ZOO_HREF}versions/1/\&quot;] \
    versions:=[\&quot;${ISO_HREF}versions/3/\&quot;,\&quot;${ZOO_HREF}versions/3/\&quot;]
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Note</strong> that specifying <code class="docutils literal notranslate"><span class="pre">start_versions=</span></code> without specifying <code class="docutils literal notranslate"><span class="pre">full=False</span></code> (i.e., asking for an incremental export)
is an error, since it makes no sense to specify a ‘starting version’ for a full export.</p>
</div>
</section>
<section id="exporting-chunked-files">
<h3>Exporting Chunked Files<a class="headerlink" href="#exporting-chunked-files" title="Permalink to this heading">¶</a></h3>
<p>By default, PulpExport streams data into a single <code class="docutils literal notranslate"><span class="pre">.tar.gz</span></code> file. Since <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a>
can contain a lot of artifacts and content, that can result in a file too large to be
copied to transport media. In this case, you can specify a maximum-file-size, and the
export process will chunk the tar.gz into a series of files no larger than this.</p>
<p>You accomplish this by setting the <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code> parameter to the desired maximum number of bytes. This
parameter takes an integer, or size-units of KB, MB, or GB. Files appear in the Exporter.path
directory, with a four-digit sequence number suffix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span> <span class="n">POST</span> <span class="p">:</span><span class="o">/</span><span class="n">pulp</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="n">exporters</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">pulp</span><span class="o">/</span><span class="mi">1</span><span class="n">ddbe6bf</span><span class="o">-</span><span class="n">a6c3</span><span class="o">-</span><span class="mi">4</span><span class="n">a88</span><span class="o">-</span><span class="mi">8614</span><span class="o">-</span><span class="n">ad9511d21b94</span><span class="o">/</span><span class="n">exports</span><span class="o">/</span> <span class="n">chunk_size</span><span class="o">=</span><span class="s2">&quot;10KB&quot;</span>
    <span class="p">{</span>
        <span class="s2">&quot;task&quot;</span><span class="p">:</span> <span class="s2">&quot;/pulp/api/v3/tasks/da3350f7-0102-4dd5-81e0-81becf3ffdc7/&quot;</span>
    <span class="p">}</span>
<span class="n">ls</span> <span class="o">-</span><span class="n">l</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">exports</span><span class="o">/</span>
    <span class="mi">10</span><span class="n">K</span> <span class="n">export</span><span class="o">-</span><span class="mi">780822</span><span class="n">a4</span><span class="o">-</span><span class="n">d280</span><span class="o">-</span><span class="mi">4</span><span class="n">ed0</span><span class="o">-</span><span class="n">a53c</span><span class="o">-</span><span class="mi">382</span><span class="n">a887576a6</span><span class="o">-</span><span class="mf">20200522_2325.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span><span class="mf">.0000</span>
    <span class="mi">10</span><span class="n">K</span> <span class="n">export</span><span class="o">-</span><span class="mi">780822</span><span class="n">a4</span><span class="o">-</span><span class="n">d280</span><span class="o">-</span><span class="mi">4</span><span class="n">ed0</span><span class="o">-</span><span class="n">a53c</span><span class="o">-</span><span class="mi">382</span><span class="n">a887576a6</span><span class="o">-</span><span class="mf">20200522_2325.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span><span class="mf">.0001</span>
    <span class="mi">10</span><span class="n">K</span> <span class="n">export</span><span class="o">-</span><span class="mi">780822</span><span class="n">a4</span><span class="o">-</span><span class="n">d280</span><span class="o">-</span><span class="mi">4</span><span class="n">ed0</span><span class="o">-</span><span class="n">a53c</span><span class="o">-</span><span class="mi">382</span><span class="n">a887576a6</span><span class="o">-</span><span class="mf">20200522_2325.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span><span class="mf">.0002</span>
    <span class="mi">10</span><span class="n">K</span> <span class="n">export</span><span class="o">-</span><span class="mi">780822</span><span class="n">a4</span><span class="o">-</span><span class="n">d280</span><span class="o">-</span><span class="mi">4</span><span class="n">ed0</span><span class="o">-</span><span class="n">a53c</span><span class="o">-</span><span class="mi">382</span><span class="n">a887576a6</span><span class="o">-</span><span class="mf">20200522_2325.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span><span class="mf">.0003</span>
    <span class="mi">10</span><span class="n">K</span> <span class="n">export</span><span class="o">-</span><span class="mi">780822</span><span class="n">a4</span><span class="o">-</span><span class="n">d280</span><span class="o">-</span><span class="mi">4</span><span class="n">ed0</span><span class="o">-</span><span class="n">a53c</span><span class="o">-</span><span class="mi">382</span><span class="n">a887576a6</span><span class="o">-</span><span class="mf">20200522_2325.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span><span class="mf">.0004</span>
    <span class="mi">10</span><span class="n">K</span> <span class="n">export</span><span class="o">-</span><span class="mi">780822</span><span class="n">a4</span><span class="o">-</span><span class="n">d280</span><span class="o">-</span><span class="mi">4</span><span class="n">ed0</span><span class="o">-</span><span class="n">a53c</span><span class="o">-</span><span class="mi">382</span><span class="n">a887576a6</span><span class="o">-</span><span class="mf">20200522_2325.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span><span class="mf">.0005</span>
    <span class="mf">2.3</span><span class="n">K</span> <span class="n">export</span><span class="o">-</span><span class="mi">780822</span><span class="n">a4</span><span class="o">-</span><span class="n">d280</span><span class="o">-</span><span class="mi">4</span><span class="n">ed0</span><span class="o">-</span><span class="n">a53c</span><span class="o">-</span><span class="mi">382</span><span class="n">a887576a6</span><span class="o">-</span><span class="mf">20200522_2325.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span><span class="mf">.0006</span>
    <span class="mi">1168</span> <span class="n">export</span><span class="o">-</span><span class="mi">780822</span><span class="n">a4</span><span class="o">-</span><span class="n">d280</span><span class="o">-</span><span class="mi">4</span><span class="n">ed0</span><span class="o">-</span><span class="n">a53c</span><span class="o">-</span><span class="mi">382</span><span class="n">a887576a6</span><span class="o">-</span><span class="mi">20200522_2325</span><span class="o">-</span><span class="n">toc</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>The “table of contents” lists all the resulting files and their checksums:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">json</span><span class="o">.</span><span class="n">tool</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">exports</span><span class="o">/</span><span class="n">export</span><span class="o">-</span><span class="mi">780822</span><span class="n">a4</span><span class="o">-</span><span class="n">d280</span><span class="o">-</span><span class="mi">4</span><span class="n">ed0</span><span class="o">-</span><span class="n">a53c</span><span class="o">-</span><span class="mi">382</span><span class="n">a887576a6</span><span class="o">-</span><span class="mi">20200522_2325</span><span class="o">-</span><span class="n">toc</span><span class="o">.</span><span class="n">json</span>
<span class="p">{</span>
    <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;chunk_size&quot;</span><span class="p">:</span> <span class="mi">10240</span><span class="p">,</span>
        <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;export-8c1891a3-ffb5-41a7-b141-51daa0e38a18-20200717_1947.tar.gz&quot;</span><span class="p">,</span>
        <span class="s2">&quot;global_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;eaef962943915ecf6b5e45877b162364284bd9c4f367d9c96d18c408012ef424&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;export-780822a4-d280-4ed0-a53c-382a887576a6-20200522_2325.tar.gz.0000&quot;</span><span class="p">:</span> <span class="s2">&quot;8156874798802f773bcbaf994def6523888922bde7a939bc8ac795a5cbb25b85&quot;</span><span class="p">,</span>
        <span class="s2">&quot;export-780822a4-d280-4ed0-a53c-382a887576a6-20200522_2325.tar.gz.0001&quot;</span><span class="p">:</span> <span class="s2">&quot;e52fac34b0b7b1d8602f5c116bf9d3eb5363d2cae82f7cc00cc4bd5653ded852&quot;</span><span class="p">,</span>
        <span class="s2">&quot;export-780822a4-d280-4ed0-a53c-382a887576a6-20200522_2325.tar.gz.0002&quot;</span><span class="p">:</span> <span class="s2">&quot;df4a2ea551ff41e9fb046e03aa36459f216d4bcb07c23276b78a96b98ae2b517&quot;</span><span class="p">,</span>
        <span class="s2">&quot;export-780822a4-d280-4ed0-a53c-382a887576a6-20200522_2325.tar.gz.0003&quot;</span><span class="p">:</span> <span class="s2">&quot;27a6ecba3cc51965fdda9ec400f5610ff2aa04a6834c01d0c91776ac21a0e9bb&quot;</span><span class="p">,</span>
        <span class="s2">&quot;export-780822a4-d280-4ed0-a53c-382a887576a6-20200522_2325.tar.gz.0004&quot;</span><span class="p">:</span> <span class="s2">&quot;f35c5a96fccfe411c074463c0eb0a77b39fa072ba160903d421c08313aba58f8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;export-780822a4-d280-4ed0-a53c-382a887576a6-20200522_2325.tar.gz.0005&quot;</span><span class="p">:</span> <span class="s2">&quot;13458b10465b01134bde49319d6b5cba9948016448da9d35cb447265a25e3caa&quot;</span><span class="p">,</span>
        <span class="s2">&quot;export-780822a4-d280-4ed0-a53c-382a887576a6-20200522_2325.tar.gz.0006&quot;</span><span class="p">:</span> <span class="s2">&quot;a1986a0590943c9bb573c7d7170c428457ce54efe75f55997259ea032c585a35&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="updating-an-exporter">
<h3>Updating an Exporter<a class="headerlink" href="#updating-an-exporter" title="Permalink to this heading">¶</a></h3>
<p>You can update an Exporter to modify a subset of its fields:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http PATCH :${EXPORTER_HREF} path=/tmp/newpath
</pre></div>
</div>
</section>
</section>
<section id="importing">
<h2>Importing<a class="headerlink" href="#importing" title="Permalink to this heading">¶</a></h2>
<section id="creating-the-importer">
<h3>Creating the importer<a class="headerlink" href="#creating-the-importer" title="Permalink to this heading">¶</a></h3>
<p>The first step to importing a Pulp export archive is to create an importer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span> <span class="p">:</span><span class="o">/</span><span class="n">pulp</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="n">importers</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">pulp</span><span class="o">/</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test&quot;</span>
</pre></div>
</div>
<p>By default, Pulp will map <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a> in the export to <a class="reference internal" href="../glossary.html#term-Repository"><span class="xref std std-term">Repositories</span></a>
in Pulp by name. This can be overriden by supplying a repo mapping that maps names from the Pulp export
to the names of repos in Pulp. For example, suppose the name of the repo in the Pulp export achive was
‘source’ and the repo in Pulp was ‘dest’. The following command would set up this mapping:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span> <span class="p">:</span><span class="o">/</span><span class="n">pulp</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="n">importers</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">pulp</span><span class="o">/</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test&quot;</span> <span class="n">repo_mapping</span><span class="o">:=</span><span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">source</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">dest</span><span class="se">\&quot;</span><span class="s2">}&quot;</span>
</pre></div>
</div>
<p>After the importer is created, a POST request to create an import will trigger the import process.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, the Pulp import machinery expects destination repositories to be present at the time
of the import. This can be overridden by passing the <code class="docutils literal notranslate"><span class="pre">create_repositories=True</span></code> field via the
POST request that will lead Pulp to create missing repositories on the fly.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The options <code class="docutils literal notranslate"><span class="pre">repo_mapping</span></code> and <code class="docutils literal notranslate"><span class="pre">create_repositories</span></code> are not compatible with each other. The
existence of a repository specified in the <code class="docutils literal notranslate"><span class="pre">repo_mapping</span></code> option is tested before the importer
is initialized. Thus, the repository has to be already created in advance.</p>
</div>
<p>You can import an exported <code class="docutils literal notranslate"><span class="pre">.tar.gz</span></code> directly using the <code class="docutils literal notranslate"><span class="pre">path</span></code> parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span> <span class="n">POST</span> <span class="p">:</span><span class="o">/</span><span class="n">pulp</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="n">importers</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">pulp</span><span class="o">/</span><span class="n">f8acba87</span><span class="o">-</span><span class="mi">0250</span><span class="o">-</span><span class="mi">4640</span><span class="o">-</span><span class="n">b56b</span><span class="o">-</span><span class="n">c92597d344b7</span><span class="o">/</span><span class="n">imports</span><span class="o">/</span> \
  <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/data/export-113c8950-072b-432a-9da6-24da1f4d0a02-20200408_2015.tar.gz&quot;</span>
</pre></div>
</div>
<p>Or you can point the importer at the “table of contents” file that was produced by an export.
If the TOC file is in the same directory as the export-files it points to, the import process
will:</p>
<blockquote>
<div><ul class="simple">
<li><p>verify the checksum(s) of all export-files,</p></li>
<li><p>reassemble a chunked-export into a single <code class="docutils literal notranslate"><span class="pre">.tar.gz</span></code></p></li>
<li><p>remove chunks as they are used (in order to conserve disk space)</p></li>
<li><p>verify the checksum of the resulting reassembled <code class="docutils literal notranslate"><span class="pre">.tar.gz</span></code></p></li>
</ul>
</div></blockquote>
<p>and then import the result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span> <span class="n">POST</span> <span class="p">:</span><span class="o">/</span><span class="n">pulp</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="n">importers</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">pulp</span><span class="o">/</span><span class="n">f8acba87</span><span class="o">-</span><span class="mi">0250</span><span class="o">-</span><span class="mi">4640</span><span class="o">-</span><span class="n">b56b</span><span class="o">-</span><span class="n">c92597d344b7</span><span class="o">/</span><span class="n">imports</span><span class="o">/</span> \
  <span class="n">toc</span><span class="o">=</span><span class="s2">&quot;/data/export-113c8950-072b-432a-9da6-24da1f4d0a02-20200408_2015-toc.json&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The directory containing the file pointed to by <code class="docutils literal notranslate"><span class="pre">path</span></code> or <code class="docutils literal notranslate"><span class="pre">toc</span></code> must be defined in the
<code class="docutils literal notranslate"><span class="pre">ALLOWED_IMPORT_PATHS</span></code> setting or the import will fail.</p>
</div>
<p>The command to create an import will return a task that can be used to monitor the import. You can
also see a history of past imports:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span> <span class="p">:</span><span class="o">/</span><span class="n">pulp</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="n">importers</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">pulp</span><span class="o">/</span><span class="n">f8acba87</span><span class="o">-</span><span class="mi">0250</span><span class="o">-</span><span class="mi">4640</span><span class="o">-</span><span class="n">b56b</span><span class="o">-</span><span class="n">c92597d344b7</span><span class="o">/</span><span class="n">imports</span><span class="o">/</span>
</pre></div>
</div>
</section>
<section id="pre-validating-import-parameters">
<h3>Pre-validating import parameters<a class="headerlink" href="#pre-validating-import-parameters" title="Permalink to this heading">¶</a></h3>
<p>There are a number of things that can keep an import from being successful, ranging from a specified
export-file not being available to bad JSON specified for <code class="docutils literal notranslate"><span class="pre">repo_mapping</span></code>. You can pre-validate your
proposed import using the <code class="docutils literal notranslate"><span class="pre">import-check</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span> <span class="n">POST</span> <span class="p">:</span><span class="o">/</span><span class="n">pulp</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="n">importers</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">pulp</span><span class="o">/</span><span class="n">import</span><span class="o">-</span><span class="n">check</span><span class="o">/</span> \
  <span class="n">path</span><span class="o">=/</span><span class="n">tmp</span><span class="o">/</span><span class="n">export</span><span class="o">-</span><span class="n">file</span><span class="o">-</span><span class="n">path</span> <span class="n">toc</span><span class="o">=/</span><span class="n">tmp</span><span class="o">/</span><span class="n">export</span><span class="o">-</span><span class="n">toc</span><span class="o">-</span><span class="n">path</span> <span class="n">repo_mapping</span><span class="o">:=</span><span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">source</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">dest</span><span class="se">\&quot;</span><span class="s2">}&quot;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">import-check</span></code> will validate that:</p>
<blockquote>
<div><ul class="simple">
<li><p>paths are in <code class="docutils literal notranslate"><span class="pre">ALLOWED_IMPORT_PATHS</span></code></p></li>
<li><p>containing directory exists</p></li>
<li><p>containing directory is readable</p></li>
<li><p>path/toc file(s) exist and are readable</p></li>
<li><p>for TOC, containing directory is writeable</p></li>
<li><p>repo_mapping is valid JSON</p></li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">import-check</span></code> is a low-overhead synchronous call. It does not attempt to do validations that
require database access or long-running tasks such as verifying checksums. All parameters are optional.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For <code class="docutils literal notranslate"><span class="pre">path</span></code> and <code class="docutils literal notranslate"><span class="pre">toc</span></code>, if the ALLOWED_IMPORT_PATHS check fails, no further information will be given.</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="reclaim-disk-space.html" class="btn btn-neutral float-left" title="Reclaim disk space for a list of repositories" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="labels.html" class="btn btn-neutral float-right" title="Labels" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012-2023, Pulp Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-74748547-2', 'auto');
  ga('send', 'pageview');

</script>


<script>
$( document ).ready( function() {

  // gets version number minus whitespace and bugfix version
  var $version_number = $('.version').text().trim().split('.', 2).join('.')

  // div mirroring the admonition-warning generated by sphinx if added to .rst
  var warning = '\
          <div class="admonition warning"> \
              <p class="first admonition-title">Warning</p> \
              <p class="last">You are looking at the docs for an unsupported version of Pulp. \
               Consider switching to a  \
               <a href="https://pulpproject.org/docs/">supported version</a></p> \
          </div>'

  
  // get JSON from server and load supported_versions
  $.getJSON("https://raw.githubusercontent.com/pulp/pulp-ci/master/ci/config/releases/supported-releases.json" , function(data) {
    if ($.inArray($version_number, data) === -1) {
      $('.rst-content').prepend(warning)
      }
    })
  })
  </script>


</body>
</html>
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reclaim disk space for a list of repositories &mdash; Pulp Project 3.23.0.dev documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Pulp Import and Export" href="import-export.html" />
    <link rel="prev" title="Repairing Pulp" href="repairing-pulp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Pulp Project
          </a>
              <div class="version">
                3.23.0.dev
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../concepts.html">Concepts and Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../from-pulp-2.html">Changes From Pulp 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authentication/index.html">Authentication</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Workflows and Use Cases</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="alternate-content-sources.html">Alternate Content Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="upload-publish.html">Upload and Publish</a></li>
<li class="toctree-l2"><a class="reference internal" href="repo-versioning.html">Repository Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="on-demand-downloading.html">On-Demand Downloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="promotion.html">Promotion</a></li>
<li class="toctree-l2"><a class="reference internal" href="scheduling-tasks.html">Scheduling Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="exposing-content.html">Exposing Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="signed-metadata.html">Metadata Signing</a></li>
<li class="toctree-l2"><a class="reference internal" href="repairing-pulp.html">Repairing Pulp</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Reclaim disk space for a list of repositories</a></li>
<li class="toctree-l2"><a class="reference internal" href="import-export.html">Pulp Import and Export</a></li>
<li class="toctree-l2"><a class="reference internal" href="labels.html">Labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-removal.html">Plugin removal</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugin_dev/index.html">Plugin Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rest_api.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client_bindings.html">Client Bindings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bugs-features.html">Bugs, Feature and Backport Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versioning.html">Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_process.html">Pulpcore Release Process</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Pulp Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Workflows and Use Cases</a></li>
      <li class="breadcrumb-item active">Reclaim disk space for a list of repositories</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/workflows/reclaim-disk-space.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="reclaim-disk-space-for-a-list-of-repositories">
<span id="reclaim-disk-space"></span><h1>Reclaim disk space for a list of repositories<a class="headerlink" href="#reclaim-disk-space-for-a-list-of-repositories" title="Permalink to this heading">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pulp’s reclaim disk space feature is in tech-preview and may change in backwards incompatible
ways in future releases.</p>
</div>
<p>Pulp provides the ability to reclaim disk space for:</p>
<blockquote>
<div><ul class="simple">
<li><p>content that one no longer needs to serve but would like to keep in the repo for historical
reasons.</p></li>
<li><p>repos that were synced with the on_demand download policy and one would want to clear out
downloaded files for those repos. Usually, a repository that was synced with the on_demand
download policy will store artifacts locally after they have been requested by the client, but
there really isn’t a way to have pulp delete the locally stored files and free disk space if
these packages are unlikely to be used again.</p></li>
</ul>
</div></blockquote>
<p>To start a reclaim task send a POST request to <cite>/pulp/api/v3/repositories/reclaim_space/</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ RECLAIM_TASK=$(http POST :24817/pulp/api/v3/repositories/reclaim_space/ repo_hrefs:=[\&quot;/pulp/api/v3/repositories/rpm/rpm/b3a6674d-181c-4e72-9412-7cbc747480ad/\&quot;] | qq -r &#39;.task&#39;)
$ http --body :24817$RECLAIM_TASK

{
    &quot;child_tasks&quot;: [],
    &quot;created_resources&quot;: [],
    &quot;error&quot;: null,
    &quot;finished_at&quot;: &quot;2021-07-16T15:36:20.650573Z&quot;,
    &quot;logging_cid&quot;: &quot;50d1721d205c40f69defb773e32a98ff&quot;,
    &quot;name&quot;: &quot;pulpcore.app.tasks.reclaim_space.reclaim_space&quot;,
    &quot;parent_task&quot;: null,
    &quot;progress_reports&quot;: [
       {
            &quot;code&quot;: &quot;reclaim-space.artifact&quot;,
            &quot;done&quot;: 35,
            &quot;message&quot;: &quot;Reclaim disk space&quot;,
            &quot;state&quot;: &quot;completed&quot;,
            &quot;suffix&quot;: null,
            &quot;total&quot;: 35
        }
    ],
    &quot;pulp_created&quot;: &quot;2021-07-16T15:36:20.306845Z&quot;,
    &quot;pulp_href&quot;: &quot;/pulp/api/v3/tasks/20ee50bd-9392-4ebf-8f1d-d2f15474ebd6/&quot;,
    &quot;reserved_resources_record&quot;: [
        &quot;/pulp/api/v3/repositories/rpm/rpm/b3a6674d-181c-4e72-9412-7cbc747480ad/&quot;
    ],
    &quot;started_at&quot;: &quot;2021-07-16T15:36:20.370245Z&quot;,
    &quot;state&quot;: &quot;completed&quot;,
    &quot;task_group&quot;: null,
    &quot;worker&quot;: &quot;/pulp/api/v3/workers/ccc132c4-0445-4f55-b370-32c3662dce3c/&quot;
 }
</pre></div>
</div>
<p>As a result of this request, disk space will be freed-up for artifacts that are exclusive to the
list of provided repos. The content of the repository versions will not change and no repository
versions will be created or removed.</p>
<p>An optional <code class="docutils literal notranslate"><span class="pre">repo_versions_keeplist</span></code> parameter can be specified, that will contain list of repo
version hrefs which will be excluded from the artifact removal.</p>
<p>The task will remove artifacts only from content that was synced from a remote source. It will not
touch the content that was uploaded directly into Pulp.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The task will clean up artifacts regardless of the download policy. The content app will be able
to stream artifact if it is locally available, otherwise it will attempt to redownload it from
the known upstream urls. In case upstream stopped serving the corresponding file, Pulp won’t be
able to download and serve it.</p>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="repairing-pulp.html" class="btn btn-neutral float-left" title="Repairing Pulp" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="import-export.html" class="btn btn-neutral float-right" title="Pulp Import and Export" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012-2023, Pulp Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-74748547-2', 'auto');
  ga('send', 'pageview');

</script>


<script>
$( document ).ready( function() {

  // gets version number minus whitespace and bugfix version
  var $version_number = $('.version').text().trim().split('.', 2).join('.')

  // div mirroring the admonition-warning generated by sphinx if added to .rst
  var warning = '\
          <div class="admonition warning"> \
              <p class="first admonition-title">Warning</p> \
              <p class="last">You are looking at the docs for an unsupported version of Pulp. \
               Consider switching to a  \
               <a href="https://pulpproject.org/docs/">supported version</a></p> \
          </div>'

  
  // get JSON from server and load supported_versions
  $.getJSON("https://raw.githubusercontent.com/pulp/pulp-ci/master/ci/config/releases/supported-releases.json" , function(data) {
    if ($.inArray($version_number, data) === -1) {
      $('.rst-content').prepend(warning)
      }
    })
  })
  </script>


</body>
</html>